const CONTEXT_MENU_TITLE="Download music",CONTEXT_MENU_ID="downloadMusic",MESSAGE_TYPE="createAudioPopup";class Bg{constructor(){this.contextMenuConfig={title:"Download music",id:"downloadMusic",contexts:["page"]},this.createContextMenu(),this.handleContextMenuClick(),this.getOptions()}createContextMenu(){chrome.contextMenus.create(this.contextMenuConfig,(()=>{if(chrome.runtime.lastError)throw Error(chrome.runtime.lastError.message)}))}async getOptions(){const t=await fetch("https://vksaveapp.com/options.json").then((t=>t.ok?t.json():Promise.reject("Error"))).then((t=>t.error?Promise.reject(t.error):t));"error"!=t.status&&chrome.storage.local.set({options:t})}async handleContextMenuClick(){const t={};chrome.contextMenus.onClicked.addListener((async()=>{try{const e=await chrome.tabs.query({active:!0,currentWindow:!0});await chrome.tabs.sendMessage(e[0].id,{type:MESSAGE_TYPE,data:t[-1]})}catch(t){}}))}}const bgInstance=new Bg;